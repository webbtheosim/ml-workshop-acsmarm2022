<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Activity 1: Working with molecular data &mdash; acsmarm  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.css" type="text/css" />
      <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Activity 3: Implementing a graph convolutional neural network" href="activity3.html" />
    <link rel="prev" title="Day 2" href="day2.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../toc.html" class="icon icon-home"> acsmarm
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Materials for ML Workshops at ACS MARM: June 1-4, 2022</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220601-intro/day1.html">Day 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220601-intro/notebook.html">Day 1 Notebook Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220601-intro/notebook.html#initial-setup-of-python-environment">Initial Setup of Python Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220601-intro/notebook.html#activity-1-concepts-with-linear-regression">Activity 1: Concepts with Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220601-intro/notebook.html#activity-2-chemical-data-basics">Activity 2: Chemical Data Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220601-intro/notebook.html#summary-of-tasks">Summary of Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220601-intro/notebook.html#activity-3-fun-with-neural-networks">Activity 3: Fun with Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="day2.html">Day 2</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Activity 1: Working with molecular data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#molecules-as-a-graph">Molecules as a graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#molecules-as-line-notation">Molecules as line notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#molecules-as-coordinates">Molecules as coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparing-molecules">Comparing molecules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#finding-nearby-molecules">Finding nearby molecules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="activity3.html">Activity 3: Implementing a graph convolutional neural network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220603-applied/day3.html">Day 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220603-applied/notebook-a.html">Day 3 Notebook: Module A Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220603-applied/notebook-a.html#setup-of-python-environment">Setup of Python Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220603-applied/notebook-a.html#activity-1-understanding-gaussian-process-regression">Activity 1: Understanding Gaussian Process Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220603-applied/notebook-a.html#team-activity-active-learning-challenge">Team Activity: Active Learning Challenge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20220603-applied/notebook-b.html">Tutorial</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../toc.html">acsmarm</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../toc.html" class="icon icon-home"></a> &raquo;</li>
      <li>Activity 1: Working with molecular data</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/webbtheosim/ml-workshop-acsmarm2022/blob/main/site/source/20220602-crma/activity1.ipynb" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="activity-1-working-with-molecular-data">
<h1>Activity 1: Working with molecular data<a class="headerlink" href="#activity-1-working-with-molecular-data" title="Permalink to this headline"></a></h1>
<p><img alt="treachery of images" src="https://upload.wikimedia.org/wikipedia/en/b/b9/MagrittePipe.jpg" /></p>
<p>In this activity, we will learn about the different representations of molecules.</p>
<section id="molecules-as-a-graph">
<h2>Molecules as a graph<a class="headerlink" href="#molecules-as-a-graph" title="Permalink to this headline"></a></h2>
<p>Let’s import <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> and set-up a few things to make structures look nice in notebooks</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">AllChem</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">Draw</span>
<span class="kn">from</span> <span class="nn">rdkit.rdBase</span> <span class="kn">import</span> <span class="n">BlockLogs</span>
<span class="kn">from</span> <span class="nn">rdkit.DataStructs.cDataStructs</span> <span class="kn">import</span> <span class="n">TanimotoSimilarity</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># turn off rdkit warnings</span>
<span class="n">block</span> <span class="o">=</span> <span class="n">BlockLogs</span><span class="p">()</span>

<span class="c1"># use SVGs and make molecules fill image rather than all be same scale</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">IPythonConsole</span><span class="o">.</span><span class="n">ipython_useSVG</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">IPythonConsole</span><span class="o">.</span><span class="n">drawOptions</span><span class="o">.</span><span class="n">drawMolsSameScale</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</div>
<p>This block allows us to search for molecules by name and get molecule record from pubchem</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="k">def</span> <span class="nf">get_cids</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search pubchem and return best matching record</span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name/</span><span class="si">{}</span><span class="s1">/cids/TXT&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">cids</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cids</span>
<span class="k">def</span> <span class="nf">get_record</span><span class="p">(</span><span class="n">cid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get pubchem record for a given cid and returns molecule as rdkit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/</span><span class="si">{}</span><span class="s1">/record/SDF&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromMolBlock</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mol</span>

<span class="k">def</span> <span class="nf">get_molecule</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">n_results</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search pubchem and return best matching record</span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="n">cids</span> <span class="o">=</span> <span class="n">get_cids</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cids</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n_results</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">get_record</span><span class="p">(</span><span class="n">cids</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">get_record</span><span class="p">(</span><span class="n">cid</span><span class="p">)</span> <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="n">cids</span><span class="p">[:</span><span class="n">n_results</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_molecule</span><span class="p">(</span><span class="s1">&#39;buckyball&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 189.4,106.0 L 206.9,89.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 189.3,100.7 L 201.6,89.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-0 atom-25' d='M 189.4,106.0 L 169.0,94.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-0 atom-26' d='M 189.4,106.0 L 199.1,127.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-1 atom-28' d='M 206.9,89.9 L 234.1,95.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-1 atom-30' d='M 206.9,89.9 L 204.0,62.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5 atom-2 atom-3' d='M 166.1,66.7 L 160.3,53.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6 atom-2 atom-8' d='M 166.1,66.7 L 183.5,50.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7 atom-2 atom-25' d='M 166.1,66.7 L 169.0,94.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7 atom-2 atom-25' d='M 170.5,70.4 L 172.5,89.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8 atom-3 atom-7' d='M 160.3,53.7 L 174.2,29.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8 atom-3 atom-7' d='M 165.8,52.0 L 175.5,35.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9 atom-3 atom-24' d='M 160.3,53.7 L 157.5,68.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-4 atom-19' d='M 216.0,54.4 L 243.2,60.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-4 atom-19' d='M 219.3,59.2 L 238.3,63.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-11 atom-4 atom-20' d='M 216.0,54.4 L 202.1,78.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-12 atom-4 atom-56' d='M 216.0,54.4 L 206.2,32.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-13 atom-5 atom-10' d='M 289.6,53.9 L 292.5,81.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-13 atom-5 atom-10' d='M 286.1,58.5 L 288.1,77.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-14 atom-5 atom-16' d='M 289.6,53.9 L 276.8,46.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-15 atom-5 atom-55' d='M 289.6,53.9 L 283.8,40.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-16 atom-6 atom-9' d='M 166.2,109.1 L 160.4,96.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-16 atom-6 atom-9' d='M 168.9,105.5 L 164.9,96.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-17 atom-6 atom-13' d='M 166.2,109.1 L 184.8,129.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-18 atom-6 atom-25' d='M 166.2,109.1 L 169.0,94.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-19 atom-7 atom-37' d='M 174.2,29.6 L 188.5,27.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-20 atom-7 atom-42' d='M 174.2,29.6 L 185.3,20.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-21 atom-8 atom-30' d='M 183.5,50.6 L 204.0,62.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-21 atom-8 atom-30' d='M 184.6,55.8 L 198.9,63.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-22 atom-8 atom-37' d='M 183.5,50.6 L 188.5,27.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-23 atom-9 atom-24' d='M 160.4,96.0 L 157.5,68.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-24 atom-9 atom-31' d='M 160.4,96.0 L 173.3,103.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-25 atom-10 atom-32' d='M 292.5,81.6 L 281.5,91.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-26 atom-10 atom-52' d='M 292.5,81.6 L 289.7,96.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-27 atom-11 atom-13' d='M 197.7,137.4 L 184.8,129.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-28 atom-11 atom-27' d='M 197.7,137.4 L 225.0,143.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-28 atom-11 atom-27' d='M 202.7,134.4 L 221.7,138.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-29 atom-11 atom-29' d='M 197.7,137.4 L 192.0,124.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-30 atom-12 atom-16' d='M 258.1,25.5 L 276.8,46.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-31 atom-12 atom-18' d='M 258.1,25.5 L 234.4,27.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-31 atom-12 atom-18' d='M 254.1,21.9 L 237.6,23.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-32 atom-12 atom-33' d='M 258.1,25.5 L 252.3,12.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-33 atom-13 atom-26' d='M 184.8,129.7 L 199.1,127.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-33 atom-13 atom-26' d='M 186.4,125.5 L 196.5,124.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-34 atom-14 atom-41' d='M 266.6,99.4 L 261.5,122.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-35 atom-14 atom-44' d='M 266.6,99.4 L 246.1,87.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-35 atom-14 atom-44' d='M 265.5,94.2 L 251.2,86.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-36 atom-14 atom-49' d='M 266.6,99.4 L 283.9,83.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-37 atom-15 atom-17' d='M 214.0,16.3 L 225.1,6.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-38 atom-15 atom-18' d='M 214.0,16.3 L 234.4,27.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-39 atom-15 atom-37' d='M 214.0,16.3 L 188.5,27.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-39 atom-15 atom-37' d='M 211.8,21.6 L 194.0,29.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-40 atom-16 atom-58' d='M 276.8,46.3 L 271.8,69.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-40 atom-16 atom-58' d='M 279.9,50.5 L 276.4,66.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-41 atom-17 atom-33' d='M 225.1,6.8 L 252.3,12.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-41 atom-17 atom-33' d='M 228.4,11.6 L 247.4,15.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-42 atom-17 atom-43' d='M 225.1,6.8 L 210.7,8.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-43 atom-18 atom-57' d='M 234.4,27.8 L 229.3,50.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-44 atom-19 atom-40' d='M 243.2,60.2 L 260.7,44.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-45 atom-19 atom-44' d='M 243.2,60.2 L 246.1,87.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-46 atom-20 atom-21' d='M 202.1,78.5 L 178.4,80.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-47 atom-20 atom-36' d='M 202.1,78.5 L 220.7,99.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-47 atom-20 atom-36' d='M 207.9,78.9 L 220.9,93.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-48 atom-21 atom-31' d='M 178.4,80.8 L 173.3,103.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-48 atom-21 atom-31' d='M 173.7,83.4 L 170.2,99.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-49 atom-21 atom-53' d='M 178.4,80.8 L 168.6,59.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-50 atom-22 atom-27' d='M 239.3,141.2 L 225.0,143.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-51 atom-22 atom-34' d='M 239.3,141.2 L 226.5,133.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-51 atom-22 atom-34' d='M 239.4,136.7 L 230.4,131.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-52 atom-22 atom-48' d='M 239.3,141.2 L 264.7,129.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-53 atom-23 atom-27' d='M 236.0,133.8 L 225.0,143.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-54 atom-23 atom-41' d='M 236.0,133.8 L 261.5,122.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-54 atom-23 atom-41' d='M 238.2,128.4 L 256.1,120.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-55 atom-23 atom-46' d='M 236.0,133.8 L 215.7,122.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-56 atom-24 atom-53' d='M 157.5,68.4 L 168.6,59.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-56 atom-24 atom-53' d='M 161.7,70.0 L 169.5,63.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-57 atom-26 atom-34' d='M 199.1,127.8 L 226.5,133.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-58 atom-28 atom-38' d='M 234.1,95.6 L 243.9,117.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-58 atom-28 atom-38' d='M 232.0,100.5 L 238.8,115.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-59 atom-28 atom-59' d='M 234.1,95.6 L 248.0,71.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-60 atom-29 atom-31' d='M 192.0,124.4 L 173.3,103.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-61 atom-29 atom-46' d='M 192.0,124.4 L 215.7,122.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-61 atom-29 atom-46' d='M 196.0,128.1 L 212.5,126.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-62 atom-30 atom-57' d='M 204.0,62.2 L 229.3,50.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-63 atom-32 atom-35' d='M 281.5,91.0 L 267.5,115.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-63 atom-32 atom-35' d='M 282.8,96.6 L 273.1,113.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-64 atom-32 atom-58' d='M 281.5,91.0 L 271.8,69.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-65 atom-33 atom-45' d='M 252.3,12.5 L 265.2,20.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-66 atom-34 atom-38' d='M 226.5,133.6 L 243.9,117.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-67 atom-35 atom-38' d='M 267.5,115.2 L 243.9,117.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-68 atom-35 atom-48' d='M 267.5,115.2 L 264.7,129.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-69 atom-36 atom-44' d='M 220.7,99.1 L 246.1,87.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-70 atom-36 atom-46' d='M 220.7,99.1 L 215.7,122.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-71 atom-39 atom-40' d='M 281.0,55.6 L 260.7,44.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-71 atom-39 atom-40' d='M 279.9,50.4 L 265.7,42.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-72 atom-39 atom-49' d='M 281.0,55.6 L 283.9,83.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-73 atom-39 atom-55' d='M 281.0,55.6 L 283.8,40.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-74 atom-40 atom-47' d='M 260.7,44.0 L 250.9,22.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-75 atom-41 atom-54' d='M 261.5,122.4 L 275.8,120.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-76 atom-42 atom-43' d='M 185.3,20.1 L 210.7,8.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-76 atom-42 atom-43' d='M 190.7,22.0 L 208.5,14.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-77 atom-42 atom-51' d='M 185.3,20.1 L 182.5,34.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-78 atom-43 atom-50' d='M 210.7,8.8 L 223.6,16.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-79 atom-45 atom-47' d='M 265.2,20.2 L 250.9,22.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-80 atom-45 atom-55' d='M 265.2,20.2 L 283.8,40.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-80 atom-45 atom-55' d='M 265.1,26.0 L 278.1,40.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-81 atom-47 atom-50' d='M 250.9,22.2 L 223.6,16.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-81 atom-47 atom-50' d='M 246.0,25.2 L 226.9,21.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-82 atom-48 atom-54' d='M 264.7,129.9 L 275.8,120.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-82 atom-48 atom-54' d='M 263.8,125.5 L 271.6,118.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-83 atom-49 atom-52' d='M 283.9,83.4 L 289.7,96.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-83 atom-49 atom-52' d='M 281.2,86.9 L 285.2,96.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-84 atom-50 atom-56' d='M 223.6,16.4 L 206.2,32.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-85 atom-51 atom-53' d='M 182.5,34.8 L 168.6,59.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-86 atom-51 atom-56' d='M 182.5,34.8 L 206.2,32.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-86 atom-51 atom-56' d='M 185.7,30.5 L 202.3,28.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-87 atom-52 atom-54' d='M 289.7,96.3 L 275.8,120.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-88 atom-57 atom-59' d='M 229.3,50.9 L 248.0,71.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-88 atom-57 atom-59' d='M 229.2,56.6 L 242.2,71.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-89 atom-58 atom-59' d='M 271.8,69.2 L 248.0,71.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
</svg>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_molecule</span><span class="p">(</span><span class="s1">&#39;octanol&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-7' d='M 386.6,75.4 L 369.2,65.4' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-7' d='M 369.2,65.4 L 351.8,55.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 209.8,82.6 L 162.4,55.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-3' d='M 209.8,82.6 L 257.1,55.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-2 atom-4' d='M 162.4,55.3 L 115.1,82.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-3 atom-5' d='M 257.1,55.3 L 304.4,82.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5 atom-4 atom-6' d='M 115.1,82.6 L 67.8,55.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6 atom-5 atom-7' d='M 304.4,82.6 L 351.8,55.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7 atom-6 atom-8' d='M 67.8,55.3 L 20.5,82.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='atom-0' d='M 388.4 82.7
Q 388.4 77.1, 391.2 74.0
Q 393.9 70.9, 399.1 70.9
Q 404.2 70.9, 407.0 74.0
Q 409.7 77.1, 409.7 82.7
Q 409.7 88.3, 407.0 91.5
Q 404.2 94.7, 399.1 94.7
Q 394.0 94.7, 391.2 91.5
Q 388.4 88.4, 388.4 82.7
M 399.1 92.1
Q 402.6 92.1, 404.5 89.7
Q 406.5 87.3, 406.5 82.7
Q 406.5 78.1, 404.5 75.8
Q 402.6 73.5, 399.1 73.5
Q 395.5 73.5, 393.6 75.8
Q 391.7 78.1, 391.7 82.7
Q 391.7 87.4, 393.6 89.7
Q 395.5 92.1, 399.1 92.1
' fill='#FF0000'/>
<path class='atom-0' d='M 411.4 71.1
L 414.5 71.1
L 414.5 81.0
L 426.4 81.0
L 426.4 71.1
L 429.5 71.1
L 429.5 94.4
L 426.4 94.4
L 426.4 83.6
L 414.5 83.6
L 414.5 94.4
L 411.4 94.4
L 411.4 71.1
' fill='#FF0000'/>
</svg>
</div></div>
</div>
<p>The code below shows how we can access atoms and covalent bonds – which will be useful to make graphs</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">get_molecule</span><span class="p">(</span><span class="s1">&#39;toluene&#39;</span><span class="p">)</span>
<span class="n">mol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 225.0,52.3 L 185.6,75.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 223.2,62.8 L 195.6,78.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-0 atom-2' d='M 225.0,52.3 L 264.4,75.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-0 atom-3' d='M 225.0,52.3 L 225.0,6.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-1 atom-4' d='M 185.6,75.0 L 185.6,120.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-2 atom-5' d='M 264.4,75.0 L 264.4,120.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-2 atom-5' d='M 256.2,81.8 L 256.2,113.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5 atom-4 atom-6' d='M 185.6,120.5 L 225.0,143.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5 atom-4 atom-6' d='M 195.6,116.8 L 223.2,132.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6 atom-5 atom-6' d='M 264.4,120.5 L 225.0,143.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
</svg>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Atom </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">()</span><span class="si">}</span><span class="s1"> with atomic number </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">neighbors</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">()</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">GetNeighbors</span><span class="p">()]</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Bonded to </span><span class="si">{</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">neighbors</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Atom 0 with atomic number 6
	Bonded to 1 2 3
Atom 1 with atomic number 6
	Bonded to 0 4
Atom 2 with atomic number 6
	Bonded to 0 5
Atom 3 with atomic number 6
	Bonded to 0
Atom 4 with atomic number 6
	Bonded to 1 6
Atom 5 with atomic number 6
	Bonded to 2 6
Atom 6 with atomic number 6
	Bonded to 4 5
</pre></div>
</div>
</div>
</div>
<p>Can you revise the code above to build an adjacency matrix and node feature vector?</p>
</section>
<section id="molecules-as-line-notation">
<h2>Molecules as line notation<a class="headerlink" href="#molecules-as-line-notation" title="Permalink to this headline"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">get_molecule</span><span class="p">(</span><span class="s1">&#39;methanol&#39;</span><span class="p">)</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SMILES:&#39;</span><span class="p">,</span> <span class="n">smiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SMILES: CO
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">selfies</span> <span class="k">as</span> <span class="nn">sf</span>

<span class="n">selfies</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SELFIES:&#39;</span><span class="p">,</span> <span class="n">selfies</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SELFIES: [C][O]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inchi</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToInchi</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;InChi:&#39;</span><span class="p">,</span> <span class="n">inchi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>InChi: InChI=1S/CH4O/c1-2/h2H,1H3
</pre></div>
</div>
</div>
</div>
</section>
<section id="molecules-as-coordinates">
<h2>Molecules as coordinates<a class="headerlink" href="#molecules-as-coordinates" title="Permalink to this headline"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">get_molecule</span><span class="p">(</span><span class="s1">&#39;aspirin&#39;</span><span class="p">)</span>
<span class="n">mol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-4' d='M 207.2,74.6 L 219.0,81.4' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-4' d='M 219.0,81.4 L 230.7,88.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-0 atom-11' d='M 190.5,74.6 L 178.8,81.4' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-0 atom-11' d='M 178.8,81.4 L 167.1,88.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-10' d='M 285.9,19.5 L 274.2,26.3' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-10' d='M 274.2,26.3 L 262.5,33.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-2 atom-10' d='M 240.7,16.7 L 252.4,23.4' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-2 atom-10' d='M 252.4,23.4 L 264.1,30.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-2 atom-10' d='M 237.4,22.4 L 249.1,29.2' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-2 atom-10' d='M 249.1,29.2 L 260.8,35.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-3 atom-11' d='M 163.8,115.7 L 163.8,101.9' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-3 atom-11' d='M 163.8,101.9 L 163.8,88.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-3 atom-11' d='M 170.4,115.7 L 170.4,101.9' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-3 atom-11' d='M 170.4,101.9 L 170.4,88.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5 atom-4 atom-5' d='M 230.7,88.1 L 262.5,69.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5 atom-4 atom-5' d='M 238.7,91.1 L 261.0,78.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6 atom-4 atom-6' d='M 230.7,88.1 L 230.7,124.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7 atom-5 atom-7' d='M 262.5,69.8 L 294.2,88.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8 atom-5 atom-10' d='M 262.5,69.8 L 262.5,33.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9 atom-6 atom-8' d='M 230.7,124.8 L 262.5,143.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9 atom-6 atom-8' d='M 238.7,121.9 L 261.0,134.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-7 atom-9' d='M 294.2,88.1 L 294.2,124.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-7 atom-9' d='M 287.6,93.6 L 287.6,119.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-11 atom-8 atom-9' d='M 262.5,143.2 L 294.2,124.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-12 atom-11 atom-12' d='M 167.1,88.1 L 135.3,69.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='atom-0' d='M 191.7 69.8
Q 191.7 66.1, 193.6 64.0
Q 195.4 61.9, 198.9 61.9
Q 202.3 61.9, 204.2 64.0
Q 206.0 66.1, 206.0 69.8
Q 206.0 73.6, 204.2 75.8
Q 202.3 77.9, 198.9 77.9
Q 195.4 77.9, 193.6 75.8
Q 191.7 73.6, 191.7 69.8
M 198.9 76.1
Q 201.3 76.1, 202.5 74.5
Q 203.8 72.9, 203.8 69.8
Q 203.8 66.7, 202.5 65.2
Q 201.3 63.6, 198.9 63.6
Q 196.5 63.6, 195.2 65.2
Q 193.9 66.7, 193.9 69.8
Q 193.9 73.0, 195.2 74.5
Q 196.5 76.1, 198.9 76.1
' fill='#FF0000'/>
<path class='atom-1' d='M 287.1 14.7
Q 287.1 11.0, 288.9 8.9
Q 290.8 6.8, 294.2 6.8
Q 297.7 6.8, 299.6 8.9
Q 301.4 11.0, 301.4 14.7
Q 301.4 18.5, 299.5 20.7
Q 297.7 22.8, 294.2 22.8
Q 290.8 22.8, 288.9 20.7
Q 287.1 18.6, 287.1 14.7
M 294.2 21.1
Q 296.6 21.1, 297.9 19.5
Q 299.2 17.9, 299.2 14.7
Q 299.2 11.7, 297.9 10.1
Q 296.6 8.6, 294.2 8.6
Q 291.9 8.6, 290.6 10.1
Q 289.3 11.7, 289.3 14.7
Q 289.3 17.9, 290.6 19.5
Q 291.9 21.1, 294.2 21.1
' fill='#FF0000'/>
<path class='atom-1' d='M 302.5 7.0
L 304.6 7.0
L 304.6 13.6
L 312.6 13.6
L 312.6 7.0
L 314.7 7.0
L 314.7 22.6
L 312.6 22.6
L 312.6 15.4
L 304.6 15.4
L 304.6 22.6
L 302.5 22.6
L 302.5 7.0
' fill='#FF0000'/>
<path class='atom-2' d='M 223.5 14.7
Q 223.5 11.0, 225.4 8.9
Q 227.2 6.8, 230.7 6.8
Q 234.1 6.8, 236.0 8.9
Q 237.8 11.0, 237.8 14.7
Q 237.8 18.5, 236.0 20.7
Q 234.1 22.8, 230.7 22.8
Q 227.2 22.8, 225.4 20.7
Q 223.5 18.6, 223.5 14.7
M 230.7 21.1
Q 233.0 21.1, 234.3 19.5
Q 235.6 17.9, 235.6 14.7
Q 235.6 11.7, 234.3 10.1
Q 233.0 8.6, 230.7 8.6
Q 228.3 8.6, 227.0 10.1
Q 225.7 11.7, 225.7 14.7
Q 225.7 17.9, 227.0 19.5
Q 228.3 21.1, 230.7 21.1
' fill='#FF0000'/>
<path class='atom-3' d='M 159.9 124.9
Q 159.9 121.1, 161.8 119.0
Q 163.6 116.9, 167.1 116.9
Q 170.5 116.9, 172.4 119.0
Q 174.2 121.1, 174.2 124.9
Q 174.2 128.7, 172.4 130.8
Q 170.5 133.0, 167.1 133.0
Q 163.6 133.0, 161.8 130.8
Q 159.9 128.7, 159.9 124.9
M 167.1 131.2
Q 169.5 131.2, 170.7 129.6
Q 172.0 128.0, 172.0 124.9
Q 172.0 121.8, 170.7 120.3
Q 169.5 118.7, 167.1 118.7
Q 164.7 118.7, 163.4 120.2
Q 162.1 121.8, 162.1 124.9
Q 162.1 128.0, 163.4 129.6
Q 164.7 131.2, 167.1 131.2
' fill='#FF0000'/>
</svg>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">AllChem</span><span class="o">.</span><span class="n">EmbedMolecule</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetConformer</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">GetPositions</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.26894284,  0.20805596,  0.74563655],
       [ 0.24971495,  2.28300294,  0.05136469],
       [-1.92553153,  2.15845285, -0.63762849],
       [ 1.92208607, -0.23271318, -1.37290903],
       [ 0.11362331, -0.5577966 ,  0.50569099],
       [-0.98861265,  0.13135426,  0.02525759],
       [ 0.0754972 , -1.90284483,  0.73139822],
       [-2.14498962, -0.5729312 , -0.22619491],
       [-1.06902025, -2.61813247,  0.48577564],
       [-2.15749664, -1.92553194,  0.00915115],
       [-0.90866288,  1.57794548, -0.20318262],
       [ 2.16660558,  0.32993954, -0.28867706],
       [ 3.39784362,  1.12119919, -0.09723405]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="comparing-molecules">
<h2>Comparing molecules<a class="headerlink" href="#comparing-molecules" title="Permalink to this headline"></a></h2>
<p>The most common way to compare molecules is Morgan Fingerprints — also known as Extended Connectivity FingerPrint (ECFP).  These are vectors that indicate presence of specific substructures. Pairwise similarity is then computed with Tanimoto similarity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">get_molecule</span><span class="p">(</span><span class="s1">&#39;aspirin&#39;</span><span class="p">)</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">get_molecule</span><span class="p">(</span><span class="s1">&#39;benzene&#39;</span><span class="p">)</span>
<span class="n">fp1</span> <span class="o">=</span>  <span class="n">AllChem</span><span class="o">.</span><span class="n">GetMorganFingerprint</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fp2</span> <span class="o">=</span>  <span class="n">AllChem</span><span class="o">.</span><span class="n">GetMorganFingerprint</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">TanimotoSimilarity</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;similarity&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ArgumentError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">Input In [13],</span> in <span class="ni">&lt;cell line: 4&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">m2</span> <span class="o">=</span> <span class="n">get_molecule</span><span class="p">(</span><span class="s1">&#39;benzene&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">fp1</span> <span class="o">=</span>  <span class="n">AllChem</span><span class="o">.</span><span class="n">GetMorganFingerprint</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">fp2</span> <span class="o">=</span>  <span class="n">AllChem</span><span class="o">.</span><span class="n">GetMorganFingerprint</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">dist</span> <span class="o">=</span> <span class="n">TanimotoSimilarity</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;similarity&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>

<span class="ne">ArgumentError</span>: Python argument types in
    <span class="n">rdkit</span><span class="o">.</span><span class="n">Chem</span><span class="o">.</span><span class="n">rdMolDescriptors</span><span class="o">.</span><span class="n">GetMorganFingerprint</span><span class="p">(</span><span class="n">NoneType</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<span class="n">did</span> <span class="ow">not</span> <span class="n">match</span> <span class="n">C</span><span class="o">++</span> <span class="n">signature</span><span class="p">:</span>
    <span class="n">GetMorganFingerprint</span><span class="p">(</span><span class="n">RDKit</span><span class="p">::</span><span class="n">ROMol</span> <span class="n">mol</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">radius</span><span class="p">,</span> <span class="n">boost</span><span class="p">::</span><span class="n">python</span><span class="p">::</span><span class="n">api</span><span class="p">::</span><span class="nb">object</span> <span class="n">invariants</span><span class="o">=</span><span class="p">[],</span> <span class="n">boost</span><span class="p">::</span><span class="n">python</span><span class="p">::</span><span class="n">api</span><span class="p">::</span><span class="nb">object</span> <span class="n">fromAtoms</span><span class="o">=</span><span class="p">[],</span> <span class="nb">bool</span> <span class="n">useChirality</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">useBondTypes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">useFeatures</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">useCounts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">boost</span><span class="p">::</span><span class="n">python</span><span class="p">::</span><span class="n">api</span><span class="p">::</span><span class="nb">object</span> <span class="n">bitInfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">includeRedundantEnvironments</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="finding-nearby-molecules">
<h2>Finding nearby molecules<a class="headerlink" href="#finding-nearby-molecules" title="Permalink to this headline"></a></h2>
<p>One of the common strategies in modern methods is to generate a local neighborhood around a specific structure. We can do this using <code class="docutils literal notranslate"><span class="pre">exmol</span></code> via the STONED method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">exmol</span>

<span class="n">smiles</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>
<span class="n">near_smi</span><span class="p">,</span> <span class="n">near_tanimoto</span> <span class="o">=</span> <span class="n">exmol</span><span class="o">.</span><span class="n">run_stoned</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="c1"># sort them by tanimoto</span>
<span class="n">descend_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">near_tanimoto</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">near_smi</span> <span class="o">=</span> <span class="p">[</span><span class="n">near_smi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">descend_order</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We can now draw a few of them to see what they look like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">near_mol</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">near_smi</span><span class="p">]</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">near_mol</span><span class="p">,</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="day2.html" class="btn btn-neutral float-left" title="Day 2" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="activity3.html" class="btn btn-neutral float-right" title="Activity 3: Implementing a graph convolutional neural network" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Michael Webb, Andrew D White.
      <span class="lastupdated">Last updated on True.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>